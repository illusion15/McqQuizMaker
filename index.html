<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="static/image/parmar ssc logo.png" type="image/x-icon">
  <title>Parmar's Bulk Uploader</title>
  <meta name="description"
    content="Convert PDF question banks into beautifully formatted quizzes in seconds. Export to DOCX, PDF, or ZIP with customizable scoring." />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="static/css/index_style.css">

</head>

<body>
  <div id="top"></div>
  <header>
    <div class="header-content">
      <a href="#top" class="logo">
        <img src="static/image/parmar ssc logo.png" alt="Parmar SSC">
        <span>Parmar's Bulk Uploader</span>
      </a>

      <nav class="nav-container">
        <button class="menu-toggle" id="menuToggle" aria-label="Toggle menu">
          <i class="fas fa-bars"></i>
        </button>
        <div class="nav-links" id="navLinks">
          <a href="#top">Home</a>
          <!-- <a href="#features">Features</a>
          <a href="#how-it-works">How It Works</a> -->
          <a href="#testimonials">Testimonials</a>
          <a href="#faq">FAQ</a>
        </div>
      </nav>

      <div class="toggle-container">
        <label class="theme-switch">
          <input type="checkbox" id="modeToggle" />
          <span class="slider"></span>
        </label>
      </div>
    </div>
  </header>

  <section class="hero">
    <div class="hero-content">
      <h1>Transform PDFs into Beautifully Formatted Quizzes</h1>
      <p>Save hours of manual work by automatically converting your question banks into ready-to-use quiz formats with
        customizable scoring and layouts.</p>

      <div class="hero-buttons">
        <a href="#uploadForm" class="cta-button">
          <i class="fas fa-rocket"></i> Start Converting Now
        </a>
        <!-- <a href="#how-it-works" class="cta-button secondary">
          <i class="fas fa-play-circle"></i> See How It Works
        </a> -->
      </div>
    </div>
  </section>
<!--
  <section class="features-section" id="features">
    <h2 class="section-title">Why Choose Parmar's Bulk Uploader</h2>
    <div class="features">
      <div class="feature-card">
        <div class="feature-icon">
          <i class="fas fa-bolt"></i>
        </div>
        <h3 class="feature-title">Instant Conversion</h3>
        <p class="feature-desc">Upload your PDF and get quiz-ready documents in seconds. No more tedious manual
          formatting or copy-pasting.</p>
      </div>

      <div class="feature-card">
        <div class="feature-icon">
          <i class="fas fa-sliders-h"></i>
        </div>
        <h3 class="feature-title">Smart Customization</h3>
        <p class="feature-desc">Set scoring parameters, select question ranges, and choose from multiple output formats
          including DOCX, PDF, and ZIP.</p>
      </div>

      <div class="feature-card">
        <div class="feature-icon">
          <i class="fas fa-chart-bar"></i>
        </div>
        <h3 class="feature-title">Detailed Analytics</h3>
        <p class="feature-desc">Get a comprehensive preview of your quiz with question count, formatting issues, and
          content analysis before export.</p>
      </div>
    </div>
  </section>

  <section class="transformation-section" id="how-it-works">
    <h2 class="section-title">How It Works</h2>
    <div class="comparison-container">
      <div class="comparison-card">
        <h3 class="comparison-title">Your Input</h3>
        <img src="/static/image/before.png" alt="Original PDF Content" class="comparison-image">
        <p class="comparison-description">Upload your PDF with questions and options in the standard format. Our system
          automatically detects the structure.</p>
        <div id="imp-instruction">
          <strong><i class="fas fa-info-circle"></i> Format Requirements:</strong>
          <p>1. Questions must start with "Q" followed by a number</p>
          <p>2. Options should be labeled (A., B., C., etc.)</p>
          <p>3. Clearly mark the correct answer</p>
          <p>4. Include solution explanations if available</p>
        </div>
      </div>

      <div class="comparison-card">
        <h3 class="comparison-title">Our Output</h3>
        <img src="/static/image/after.png" alt="Formatted Quiz Output" class="comparison-image">
        <p class="comparison-description">We transform your content into a professionally formatted quiz with
          customizable scoring, answer keys, and solution guides.</p>
        <p>Try it yourself with our sample file:</p>
        <a class="sample-btn-container" href="#" download>
          <button class="sample-btn">
            <i class="fas fa-download"></i> Download Sample PDF
          </button>
        </a>
      </div>
    </div>
  </section>
-->
  <div class="container" id="uploadForm">
    <h1 class="form-title">Create Your Quiz</h1>

    <form id="uploadForm" method="POST" action="/upload" enctype="multipart/form-data">
      <div class="form-group">
        <label for="pdf_file">
          <i class="fas fa-file-pdf"></i> Upload Your File
          <div class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltip-text">Supports most PDF question banks. Max file size: 15MB.</span>
          </div>
        </label>
        <div class="drop-area" id="drop-area">
          <i class="fas fa-cloud-upload-alt"></i>
          <div class="drop-text">Drag & Drop Your File Here</div>
          <div class="drop-subtext">Or Click To Browse Files (Max 15MB)</div>
          <input type="file" id="pdf_file" name="pdf_file" accept="application/pdf/docx" hidden required />
        </div>
        <div id="file-name-display">
          <i class="fas fa-check-circle"></i>
          <span>No file selected</span>
        </div>
        <div class="progress-container" id="progress-container" style="display: none;">
          <div class="progress-bar" id="progress-bar"></div>
        </div>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label for="positive">
            <i class="fas fa-plus-circle"></i> Positive Marks
            <div class="tooltip">
              <i class="fas fa-question-circle"></i>
              <span class="tooltip-text">Points awarded for each correct answer</span>
            </div>
          </label>
          <div class="input-icon">
            <i class="fas fa-plus"></i>
            <input type="number" id="positive" name="positive" value="2" step="0.01" min="0" required />
          </div>
        </div>

        <div class="form-group">
          <label for="negative">
            <i class="fas fa-minus-circle"></i>Negative Marks
            <div class="tooltip">
              <i class="fas fa-question-circle"></i>
              <span class="tooltip-text">Points deducted for incorrect answers (set to 0 for no penalty)</span>
            </div>
          </label>
          <div class="input-icon">
            <i class="fas fa-minus"></i>
            <input type="number" id="negative" name="negative" value="0.25" step="0.01" min="0" required />
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="format">
          <i class="fas fa-file-export"></i> Output Format
          <div class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltip-text">Choose your preferred download format</span>
          </div>
        </label>
        <div class="input-icon">
          <i class="fas fa-file-export"></i>
          <select id="format" name="format">
            <option value="docx">doc (Microsoft Word)</option>
            <option value="pdf">pdf (Portable Document Format)</option>
            <option value="zip">zip (Compressed Archive)</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <!-- <label><i class="fas fa-text-height"></i> Text Formatting Options</label> -->
        <div class="checkbox-group">
          <input type="checkbox" id="bold_question" name="bold_question" value="yes" checked />
          <label for="bold_question">Want Questions Bold?</label>
        </div>
        <!-- <div class="checkbox-group">
          <input type="checkbox" id="highlight_answer" name="highlight_answer" value="yes" checked />
          <label for="highlight_answer">Highlight correct answers</label>
        </div> -->
      </div>

      <div class="checkbox-group">
        <input type="checkbox" id="generate_all" name="generate_all" value="yes" checked />
        <label for="generate_all">Process whole doc at once</label>
      </div>

      <div class="divider-line">Process a specific range</div>

      <div class="form-grid">
        <div class="form-group">
          <label for="range_start">
            <i class="fas fa-play"></i> Start Question
            <div class="tooltip">
              <i class="fas fa-question-circle"></i>
              <span class="tooltip-text">Leave blank to start from first question</span>
            </div>
          </label>
          <div class="input-icon">
            <i class="fas fa-list-ol"></i>
            <input type="number" id="range_start" name="range_start" placeholder="e.g., 1" disabled />
          </div>
        </div>

        <div class="form-group">
          <label for="range_end">
            <i class="fas fa-stop"></i> End Question
            <div class="tooltip">
              <i class="fas fa-question-circle"></i>
              <span class="tooltip-text">Leave blank to process until last question</span>
            </div>
          </label>
          <div class="input-icon">
            <i class="fas fa-list-ol"></i>
            <input type="number" id="range_end" name="range_end" placeholder="e.g., 50" disabled />
          </div>
        </div>
      </div>

      <button type="submit">
        <i class="fas fa-magic"></i> Generate Quiz & Preview
      </button>
    </form>

    <div class="preview-container">
      <div class="preview-header">
        <div class="preview-title">
          <i class="fas fa-search"></i> PDF Preview
        </div>
        <div class="preview-badge">First Page Only</div>
      </div>
      <div id="preview">
        <div class="no-preview">
          <i class="fas fa-file-pdf"></i>
          <div>Upload a PDF to see preview</div>
        </div>
      </div>
    </div>
  </div>

  <section class="testimonial-section" id="testimonials">
    <h2 class="section-title">What Educators Say</h2>
    <div class="testimonials">
      <div class="testimonial">
        <p class="testimonial-text">This tool has revolutionized how I prepare quizzes. What used to take hours now
          takes minutes! The formatted output is perfect for uploading to our LMS.</p>
        <div class="testimonial-author">
          <div class="author-avatar">P</div>
          <div class="author-info">
            <h4>Parmar SSC</h4>
            <div class="author-role">SSC/Railway/Banking Faculty</div>
          </div>
        </div>
      </div>

      <div class="testimonial">
        <p class="testimonial-text">The diagnostic report caught formatting issues I would've missed. It's like having
          an assistant who checks all my question banks before I use them.</p>
        <div class="testimonial-author">
          <div class="author-avatar">SS</div>
          <div class="author-info">
            <h4>Sanjog Saini</h4>
            <div class="author-role">University Professor</div>
          </div>
        </div>
      </div>

      <div class="testimonial">
        <p class="testimonial-text">My students love the clean format of the quizzes. The automatic scoring system saves
          me so much time during grading season.</p>
        <div class="testimonial-author">
          <div class="author-avatar">M</div>
          <div class="author-info">
            <h4>Manish</h4>
            <div class="author-role">Mentor</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="faq-section" id="faq">
    <h2 class="section-title">Frequently Asked Questions</h2>

    <div class="faq-item">
      <div class="faq-question">
        What PDF formats are supported?
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="faq-answer">
        We support most standard PDFs with text content. Scanned PDFs or image-based PDFs may not work unless they've
        been processed with OCR (Optical Character Recognition) software first.
      </div>
    </div>

    <div class="faq-item">
      <div class="faq-question">
        Is there a file size limit?
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="faq-answer">
        Yes, the current maximum file size is 15MB. For larger files, consider splitting them into smaller parts or
        compressing the PDF before uploading.
      </div>
    </div>

    <div class="faq-item">
      <div class="faq-question">
        How are the questions detected?
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="faq-answer">
        Our system looks for question numbers (Q1, Q2, etc.), followed by question text, then options (A, B, C, etc.),
        and finally the correct answer indicator. The more standardized your format, the better the detection.
      </div>
    </div>

    <div class="faq-item">
      <div class="faq-question">
        Can I edit the output after generation?
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="faq-answer">
        Absolutely! The DOCX output is fully editable in Microsoft Word or similar software. The PDF output can be
        edited with PDF editing tools.
      </div>
    </div>

    <div class="faq-item">
      <div class="faq-question">
        Is my data secure?
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="faq-answer">
        Yes, we take privacy seriously. Your files are processed securely and are automatically deleted from our servers
        after conversion. We don't store your content long-term.
      </div>
    </div>
  </section>

  <footer>
    <div class="footer-content">
      <div class="footer-logo">
        <img src="static/image/parmar ssc logo.png" alt="Parmar SSC">
        <span>Parmar's Bulk Uploader</span>
      </div>

      <div class="footer-links">
        <!-- <a href="#features"><i class="fas fa-star"></i> Features</a>
        <a href="#how-it-works"><i class="fas fa-play-circle"></i> How It Works</a> -->
        <a href="#testimonials"><i class="fas fa-comment"></i> Testimonials</a>
        <a href="#faq"><i class="fas fa-question-circle"></i> FAQ</a>
        <a href="#"><i class="fas fa-envelope"></i> Contact</a>
        <a href="#"><i class="fas fa-shield-alt"></i> Privacy</a>
      </div>

      <div class="social-links">
        <a href="#"><i class="fab fa-twitter"></i></a>
        <a href="#"><i class="fab fa-facebook-f"></i></a>
        <a href="#"><i class="fab fa-linkedin-in"></i></a>
        <a href="#"><i class="fab fa-github"></i></a>
      </div>

      <div class="copyright">
        &copy; 2025 Parmar's Bulk Uploader. All rights reserved.
      </div>
    </div>
  </footer>

  <script>
  // Helper function to load external scripts
  function loadScript(src) {
    return new Promise((resolve, reject) => {
      const script = document.createElement('script');
      script.src = src;
      script.onload = resolve;
      script.onerror = reject;
      document.head.appendChild(script);
    });
  }

  // File Upload Handling
  const dropArea = document.getElementById('drop-area');
  const fileInput = document.getElementById('pdf_file');
  const preview = document.getElementById('preview');
  const fileNameDisplay = document.getElementById('file-name-display');
  const progressContainer = document.getElementById('progress-container');
  const progressBar = document.getElementById('progress-bar');

  dropArea.addEventListener('click', () => fileInput.click());

  dropArea.addEventListener('dragover', e => {
    e.preventDefault();
    dropArea.classList.add('dragover');
  });

  dropArea.addEventListener('dragleave', () => {
    dropArea.classList.remove('dragover');
  });

  dropArea.addEventListener('drop', e => {
    e.preventDefault();
    dropArea.classList.remove('dragover');
    fileInput.files = e.dataTransfer.files;
    fileInput.dispatchEvent(new Event('change'));
  });

  fileInput.addEventListener('change', () => {
    const file = fileInput.files[0];

    if (!file || (!file.name.endsWith('.pdf') && !file.name.endsWith('.docx'))) {
      preview.innerHTML = `
        <div class="no-preview">
          <i class="fas fa-exclamation-circle"></i>
          <div>Please upload a valid <strong>.pdf</strong> or <strong>.docx</strong> file</div>
        </div>
      `;
      fileNameDisplay.innerHTML = '<i class="fas fa-times-circle"></i> Invalid file type';
      return;
    }

    // ✅ Show uploaded file name
    fileNameDisplay.innerHTML = `<i class="fas fa-check-circle"></i> ${file.name}`;

    // ✅ Show processing state
    preview.innerHTML = `
      <div class="preview-loading">
        <div class="spinner"></div>
        <div>Processing file...</div>
      </div>
    `;

    progressContainer.style.display = 'block';
    let progress = 0;
    const progressInterval = setInterval(() => {
      progress += Math.random() * 10;
      if (progress > 100) progress = 100;
      progressBar.style.width = `${progress}%`;

      if (progress === 100) {
        clearInterval(progressInterval);
        setTimeout(() => {
          progressContainer.style.display = 'none';
        }, 500);
      }
    }, 100);

    // ✅ Handle PDF file preview
    if (file.name.endsWith('.pdf')) {
      const reader = new FileReader();
      reader.onload = function (e) {
        const typedArray = new Uint8Array(e.target.result);
        pdfjsLib.getDocument({ data: typedArray }).promise.then(pdf => {
          pdf.getPage(1).then(page => {
            const viewport = page.getViewport({ scale: 1.0 });
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.height = viewport.height;
            canvas.width = viewport.width;

            page.render({ canvasContext: context, viewport: viewport }).promise.then(() => {
              const thumbnail = document.createElement('div');
              thumbnail.style.textAlign = 'center';
              thumbnail.style.marginBottom = '1.5rem';

              const img = document.createElement('img');
              img.src = canvas.toDataURL();
              img.style.maxWidth = '100%';
              img.style.borderRadius = '8px';
              img.style.boxShadow = '0 4px 10px rgba(0, 0, 0, 0.1)';
              img.style.border = '1px solid var(--border-light)';
              thumbnail.appendChild(img);

              page.getTextContent().then(content => {
                const text = content.items.map(item => item.str).join(' ');
                preview.innerHTML = '';
                preview.appendChild(thumbnail);

                const textPreview = document.createElement('div');
                textPreview.className = 'preview-content';
                textPreview.innerText = text.slice(0, 1000) + (text.length > 1000 ? '...' : '');
                preview.appendChild(textPreview);

                const pageInfo = document.createElement('div');
                pageInfo.style.marginTop = '1rem';
                pageInfo.style.fontSize = '0.9rem';
                pageInfo.style.color = 'var(--text-secondary-light)';
                pageInfo.innerHTML = `<strong>${pdf.numPages}</strong> page(s) detected - showing first page preview`;
                preview.appendChild(pageInfo);
              });
            });
          }).catch(err => {
            preview.innerHTML = `
              <div class="no-preview">
                <i class="fas fa-exclamation-triangle"></i>
                <div>Could not render PDF preview</div>
              </div>
            `;
          });
        }).catch(err => {
          preview.innerHTML = `
            <div class="no-preview">
              <i class="fas fa-exclamation-triangle"></i>
              <div>Could not load PDF. Please try another file.</div>
            </div>
          `;
          fileNameDisplay.innerHTML = '<i class="fas fa-times-circle"></i> Error loading PDF';
        });
      };
      reader.readAsArrayBuffer(file);

    } 
    // ✅ Handle DOCX file preview
    else if (file.name.endsWith('.docx')) {
      const reader = new FileReader();
      reader.onload = function(e) {
        const arrayBuffer = e.target.result;
        
        // Function to handle DOCX conversion
        const processDocx = () => {
          if (typeof mammoth !== "undefined" && mammoth.extractRawText) {
            mammoth.extractRawText({ arrayBuffer })
              .then(result => {
                const text = result.value;
                preview.innerHTML = `
                  <div class="docx-preview">
                    <i class="fas fa-file-word"></i>
                    <div class="preview-content">
                      <pre>${text.slice(0, 1000)}${text.length > 1000 ? '...' : ''}</pre>
                    </div>
                    <div class="docx-info">DOCX content preview</div>
                  </div>
                `;
              })
              .catch(error => {
                console.error('DOCX conversion error:', error);
                preview.innerHTML = `
                  <div class="no-preview">
                    <i class="fas fa-exclamation-triangle"></i>
                    <div>Could not generate DOCX preview</div>
                  </div>
                `;
              });
          } else {
            preview.innerHTML = `
              <div class="no-preview">
                <i class="fas fa-exclamation-triangle"></i>
                <div>Preview library failed to load</div>
              </div>
            `;
          }
        };

        // Load Mammoth if needed
        if (typeof mammoth === "undefined") {
          preview.innerHTML = `
            <div class="preview-loading">
              <div class="spinner"></div>
              <div>Loading preview library...</div>
            </div>
          `;
          
          loadScript('https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js')
            .then(processDocx)
            .catch(error => {
              console.error('Failed to load Mammoth:', error);
              preview.innerHTML = `
                <div class="no-preview">
                  <i class="fas fa-exclamation-triangle"></i>
                  <div>Could not load preview library</div>
                </div>
              `;
            });
        } else {
          processDocx();
        }
      };
      reader.readAsArrayBuffer(file);
    }
  });
</script>
<script>

    // Dark Mode Toggle
    document.addEventListener('DOMContentLoaded', function () {
      const body = document.body;
      const toggle = document.getElementById('modeToggle');

      // Load dark mode from localStorage
      if (localStorage.getItem('darkMode') === 'enabled') {
        body.classList.add('dark-mode');
        toggle.checked = true;
      }

      toggle.addEventListener('change', function () {
        body.classList.toggle('dark-mode');
        localStorage.setItem('darkMode', body.classList.contains('dark-mode') ? 'enabled' : 'disabled');
      });
    });

    // Form Logic
    document.getElementById("generate_all").addEventListener("change", function () {
      const disabled = this.checked;
      document.getElementById("range_start").disabled = disabled;
      document.getElementById("range_end").disabled = disabled;
    });

    // FAQ Accordion
    document.querySelectorAll('.faq-question').forEach(question => {
      question.addEventListener('click', () => {
        const item = question.parentElement;
        item.classList.toggle('active');

        // Close other open items
        document.querySelectorAll('.faq-item').forEach(otherItem => {
          if (otherItem !== item && otherItem.classList.contains('active')) {
            otherItem.classList.remove('active');
          }
        });
      });
    });

    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();

        const targetId = this.getAttribute('href');
        if (targetId === '#') return;

        const targetElement = document.querySelector(targetId);
        if (targetElement) {
          window.scrollTo({
            top: targetElement.offsetTop - 80,
            behavior: 'smooth'
          });

          // Close mobile menu if open
          const navLinks = document.getElementById('navLinks');
          if (navLinks.classList.contains('active')) {
            navLinks.classList.remove('active');
            document.getElementById('menuToggle').querySelector('i').classList.remove('fa-times');
            document.getElementById('menuToggle').querySelector('i').classList.add('fa-bars');
          }
        }
      });
    });

    // Form submission handler
    document.getElementById('uploadForm').addEventListener('submit', function (e) {
      const file = document.getElementById('pdf_file').files[0];
      if (!file) {
        e.preventDefault();
        alert('Please upload a PDF file first');
        return;
      }

      // Show loading state
      const submitButton = this.querySelector('button[type="submit"]');
      const originalText = submitButton.innerHTML;
      submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
      submitButton.disabled = true;

      // Revert after 5 seconds if something goes wrong
      setTimeout(() => {
        submitButton.innerHTML = originalText;
        submitButton.disabled = false;
      }, 5000);
    });

    // Responsive Menu Toggle
    document.getElementById('menuToggle').addEventListener('click', function () {
      const navLinks = document.getElementById('navLinks');
      navLinks.classList.toggle('active');

      // Toggle icon
      const icon = this.querySelector('i');
      if (navLinks.classList.contains('active')) {
        icon.classList.remove('fa-bars');
        icon.classList.add('fa-times');
      } else {
        icon.classList.remove('fa-times');
        icon.classList.add('fa-bars');
      }
    });

    // Close menu when clicking outside
    document.addEventListener('click', function (e) {
      const navContainer = document.querySelector('.nav-container');
      const menuToggle = document.getElementById('menuToggle');
      const navLinks = document.getElementById('navLinks');

      if (!navContainer.contains(e.target)) {
        navLinks.classList.remove('active');
        menuToggle.querySelector('i').classList.remove('fa-times');
        menuToggle.querySelector('i').classList.add('fa-bars');
      }
    });
  </script>
</body>

</html>